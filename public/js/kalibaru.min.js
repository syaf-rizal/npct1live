(function($) {
    $.fn.KalibaruModal = function(options) {
        var settings = $.extend({
            size: 'medium',
            message: '',
            title: '',
            buttonClose: true,
            logo: false,
        }, options);
        var className = '';
        var isTitle = settings.title;
        var idRand = Math.floor((Math.random() * 10000) + 1);
        var $hasClassWidth = false;
        if (settings.size == "md") {
            className = '';
        } else if (settings.size == "lg") {
            className = ' kalibaru-modal-large'
            $hasClassWidth = true;
        } else if (settings.size == "sm") {
            className = ' kalibaru-modal-small';
            $hasClassWidth = true;
        } else if (settings.size == "xs") {
            className = ' kalibaru-modal-xsmall';
            $hasClassWidth = true;
        } else if (settings.size == "announce-web" ){
            className = settings.size;
            $hasClassWidth = true;
        }else {
            className = settings.size;
            $hasClassWidth = false;
        }
        console.log(settings);
        $div = '<section class="kbaru-modal">';
        $div += '   <div class="kbaru-modal-overlay" id="' + idRand + '"> \
                        <div class="kbaru-modal-content ' + ($hasClassWidth ? settings.size : '') + '"' + (!$hasClassWidth ? ' style="width:' + settings.size + '"' : '') + '>';
                            if(settings.logo || isTitle.length > 0 || settings.buttonClose) {
                                $div += '   <div class="modal-container-header">';
                                $div += '       <div class="modal-container-title">';
                                if(settings.logo) {
                                    $div += '<span><svg width="24" height="23" viewBox="0 0 24 23" fill="none" xmlns="http://www.w3.org/2000/svg" style="margin-right: 8px;"> \
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M17.6603 1.65137L17.6949 1.67176C21.659 4.04003 23.9865 8.98194 23.0466 13.7389C22.2204 17.9249 18.9198 21.5064 14.721 22.5638C11.9001 23.2501 8.927 22.8285 6.40118 21.3841L8.89857 17.0145C9.23276 17.2123 9.58515 17.3767 9.95078 17.5054C11.4211 18.0203 13.0282 17.9636 14.4595 17.3461C15.8908 16.7287 17.044 15.5947 17.6949 14.1647C18.3458 12.7346 18.4479 11.1108 17.9812 9.60885C17.5146 8.10692 16.5126 6.83426 15.1701 6.03835L17.6675 1.66011L17.6603 1.65137Z" fill="#FDB713"/> \
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M17.6562 1.65249L15.1588 6.03073L15.0955 5.99286C14.1795 5.46593 13.1471 5.18112 12.0936 5.16474C11.04 5.14837 9.99945 5.40096 9.06792 5.89918C8.1364 6.3974 7.34401 7.12517 6.76398 8.01524C6.18395 8.90531 5.835 9.92895 5.74938 10.9916C5.56081 13.3657 6.82318 15.7849 8.8945 17.0113L6.39711 21.3808C5.76648 21.0203 5.17248 20.5979 4.62375 20.1195C1.55924 17.4366 0.0881526 13.003 1.02521 8.9248C1.96227 4.8466 5.29308 1.39614 9.40981 0.411547C12.1797 -0.23603 15.0887 0.186259 17.567 1.59568L17.6577 1.64812L17.6562 1.65249Z" fill="#002985"/> \
                                        <path fill-rule="evenodd" clip-rule="evenodd" d="M14.1306 7.42578L7.16241 12.7842L11.2115 12.5396L13.028 16.2099L14.1306 7.42578Z" fill="#FDB713"/> \
                                        </svg><span>';
                                }
                                if(isTitle.length > 0) {
                                    $div += '<span style="margin-bottom: 0; line-height: 1.5">' + settings.title + '</span>';
                                }
                                $div += '   </div>';
                                if(settings.buttonClose) {
                                    $div += ' <button class="btnKalibaruModalClose" id="KalibaruModalClose"> \
                                                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="16" height="16"> \
                                                    <path fill="none" d="M0 0h24v24H0z"></path> \
                                                    <path fill="currentColor" d="M12 10.586l4.95-4.95 1.414 1.414-4.95 4.95 4.95 4.95-1.414 1.414-4.95-4.95-4.95 4.95-1.414-1.414 4.95-4.95-4.95-4.95L7.05 5.636z"></path> \
                                                </svg>\
                                            </button>';
                                }
                                $div += '   </div>';
                            }
        $div += '           <div class="container__content">' + settings.message + '</div>';
        $div += '       </div>\
                    </div>'; 
        $div += '</section>';
        $("body").append($($div));
        $("#" + idRand).addClass('visible');
        $(document).keyup(function(e) {
            if (settings.buttonClose) {
                if (e.key == "Escape") {
                    if ($(".kbaru-modal").length > 0) {
                        $(".kbaru-modal").remove();
                    }
                }
            } else {
                return false;
            }
        });
        $(document).ready(function() {
            if (settings.buttonClose) {
                $(".btnKalibaruModalClose").on("click", function() {
                    if ($(".kbaru-modal").length > 0) {
                        $(".kbaru-modal").remove();
                    }
                    return false;
                });
            } else {
                return false;
            }
            $(".v4-close-dialog").on("click", function(){
                if ($(".kbaru-modal").length > 0) {
                    $(".kbaru-modal").remove();
                }
                return false;
            });
        });
    }
}(jQuery));